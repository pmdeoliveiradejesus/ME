%Economic Dispatch
% cp: perfect competition
% 0l: oligopoly
mO1=15;mO2=10;pmax=100;mD=20;p1min=5;p2min=10;
B=[-p1min; -p2min; -pmax; 0];
Acp=[mO1 0 0 -1; 
     0 mO2 0 -1; 
     0 0 -mD -1; 
     -1 -1 1 0];
Solcp=inv(Acp)*B
Past=Solcp(1);
P2ast=Solcp(2);
Qast=Solcp(3);

PSP1=Past*Qast-p1min*Qast-0.5*mo1*Qast*Qast-(p1min*)
CSP = pmax*Past-0.5*md*Qast*Qast-Past*Qast 
SW=PSP+CSP
%Elasticity at equilibrium point

DP=(pmax-Solcp(3));
DQ=0-Solcp(1);
e=(DQ/Qast)/(DP/Past)
